# Контекстно-свободни граматики

 Александър Иванов, ФН 81841, КН, група 4

## Функционалност	

Базовата функционалност се състои от отваряне и запазване на безконтекстни граматики, както и операции върху тях.

## Поддържани операции

`list`: Извежда списък с всички отворени граматики

`exit`: Затваря програмата

`print <id>`: Извежда граматиката със съответното id на конзолата

`open <path>`: Зарежда граматика от файл.

`save <id> <path>:` Запазва отворена граматика във файл

`union <id1> <id2>`: Създава нова граматика, чиито език е обединение на езиците на две съществуващи отворени граматики

`concat <id1> <id2>`: Създава нова граматика, чиито език е конкатенация на езиците на две съществуващи отворени граматики

`iter <id>`: Създава нова граматика, чиито език е звезда на Клини, върху езика на съществуваща отворена граматика

`chomsky <id>` : Проверка дали отворена граматика е в нормална форма на Чомски

`chomskify <id>`: Създава нова граматика, в нормална форма на Чомски, със езика на съществуваща такава.

`cyk <id> <изречение>`: Проверява дали езика на дадена граматика в нормална форма на Чомски съдържа изречението

`addrule <id> <rule-name> <израз във формат(pesho.gosho|Stamat)>`: Добавя правило към граматика

`removerule <id> <rule-name>`: Премахва правило от граматика 

## Формат за запазване на граматики

Граматиките се сериализират в следния формат:

`<име на правило> -> <израз> ;`

`AddOp -> add | sub;`
`Expr -> Term | Expr.AddOp.Term | AddOp.Term;`
`Factor -> Primary | Factor.pw.Primary;`
`MulOp -> mul | div;`
`Primary -> number | variable | opn.Expr.cls;`
`Term -> Factor | Term.MulOp.Factor;`

Първото правило във файла е началното.

## Начин на зареждане на граматиките

Зареждането на граматиките става от инстанция на`istream` - отворен файл или `stringstream`.

Първо текстът се разделя на token-и от различни типове:

`terminal`, `non_terminal`, `->`, `;`, `whitespace`, `unrecognized_character_sequence`, `union_operator`, `concatenation_operator`

Подобно на всички нормални езици за програмиране, форматът на `whitespace` и наличието и липсата на нови редове няма значение.

След първата стъпка, граматиката вече може да бъде прочетена правило по правило, като `token`-ите се кешират най-много до следващия `;`. 

Разчита се, че при запазването, началното правило е първото във файла.

## Имплементация на някои операции

### Chomskify:

Алгоритъмът е главно базиран на [описанието в Wikipedia](https://en.wikipedia.org/wiki/Chomsky_normal_form), с допълнителни сведения [от тук](https://www.cs.bgu.ac.il/~auto191/wiki.files/9a.pdf)

### Chomsky:

Също базиран на описанието в горните две статии.

**Concat, Union**

В новата граматика се прехвърлят всички правила от предишните две, с префикс `L`, `R`, за лявата и дясната граматика, съответно. След това се добавя стартово правило от вида `Start -> LStart.RStart` за конкатенация и `Start->LStart | RStart` за обединение.

### Cyk

Отново, като [в Wikipedia](https://en.wikipedia.org/wiki/CYK_algorithm), с разширение, пазещо пътя на извеждане, за да може да получим дърво на извод, ако алгоритъмът е успешен.

## Тестове

> Написани са Unit Tests за следната функционалност, за която е най-вероятно да бъдат допуснати грешки:

> Tokenization процесът трябва да извежда tokens от правилните типове за даден текст

> Конкатенация на текстовите стойности на всеки token трябва да доведе до оригиналния текст.

> Сериализиране и десериализиране на граматика трябва да доведе до идентична граматика на оригиналната 

> Chomskify води до граматика в нормална форма

> Cyk алгоритъм разпознава валидни аритметични изрази

